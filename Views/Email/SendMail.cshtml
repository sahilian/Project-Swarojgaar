@{
    ViewData["Title"] = "Send Mail";
}

<link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
<script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
<script src="https://cdn.quilljs.com/1.3.6/quill.snow.js"></script>

<h1>Send Mail to Candidate:</h1>

<form id="form">
    <div class="mb-3">
        <label class="form-label" for="from_name">From Name:</label>
        <input type="text" class="form-control" name="from_name" id="from_name" required>
    </div>
    <div class="mb-3">
        <label class="form-label" for="to_name">To Email:</label>
        <input type="email" class="form-control" name="to_name" id="to_name" required>
    </div>
    <div class="mb-3">
        <label class="form-label" for="subject">Subject:</label>
        <input type="text" class="form-control" name="subject" id="subject" required>
    </div>
    <div class="mb-3">
        <label class="form-label" for="message">Message:</label>
        <div class="form-control" id="editor" style="height: 200px;"></div>
    </div>

    <input type="submit" class="btn btn-primary" id="button" value="Send Email">
</form>

<script>
    const quill = new Quill('#editor', {
        modules: {
            toolbar: [
                ['bold', 'italic'],
                ['link', 'blockquote', 'code-block', 'image'],
                [{ list: 'ordered' }, { list: 'bullet' }],
            ],
        },
        theme: 'snow', //here i am using the quill's snow theme for toolbar
    });

    const btn = document.getElementById('button');

    document.getElementById('form').addEventListener('submit', function (event) {
        event.preventDefault();

        btn.value = 'Sending...';

        const data = {
            from_name: document.getElementById('from_name').value,
            to_name: document.getElementById('to_name').value,
            subject: document.getElementById('subject').value,
            message: quill.root.innerHTML,
        };

        fetch('/Email/SendMail', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
        })
            .then(response => response.json())
            .then(result => {
                btn.value = 'Send Email';
                alert(result.message);
                window.location.href = '/Jobs';
            })
            .catch(error => {
                btn.value = 'Send Email';
                alert('Error: ' + error.message);
            });
    });
</script>
